---
# To reduce the latency (improve performance), the inventory contains the
#
# - region filter
# - cache
# - filters
# - strict_permissions

plugin: amazon.aws.aws_ec2

regions:
  - "{{ lookup('env', 'AWS_DEFAULT_REGION') | default('eu-north-1') }}"

cache: true
cache_timeout: 300  # 5 minutes cache

# Only runnng instances are billed (as of 2025-07-13),
# see https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html
filters:
  instance-state-name: running

strict_permissions: false

keyed_groups:
  - key: tags.platform
    prefix: ""
    separator: ""
  - key: tags.platform
    prefix: "aws_ec2"
    separator: "_"

hostnames:
  - tag:Name

compose:
  ansible_host: public_ip_address